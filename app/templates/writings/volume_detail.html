{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h2>{{ volume.title }}</h2>
    <p class="text-muted">Volume of <a href="{{ url_for('main.novel_detail_slug', novel_slug=novel.slug) }}">{{ novel.title }}</a></p>
    {% if volume.summary %}<p>{{ volume.summary }}</p>{% endif %}
    
    {% if current_user.is_authenticated and current_user == novel.story.author %}
    <a href="{{ url_for('main.new_chapter', novel_slug=novel.slug, volume_slug=volume.slug) }}" class="btn btn-outline-success btn-sm">+ Add Chapter</a>
    <a href="{{ url_for('main.edit_volume', volume_slug=volume.slug) }}" class="btn btn-outline-secondary btn-sm">Edit Volume</a>
    <form method="POST" action="{{ url_for('main.delete_volume', volume_slug=volume.slug) }}" style="display:inline;" onsubmit="return confirm('Delete this volume and all its chapters?');">
        <button type="submit" class="btn btn-outline-danger btn-sm">Delete Volume</button>
    </form>
    {% endif %}

    <h4 class="mt-4">Chapters</h4>
    {% if chapters %}
        <div class="list-group">
            {% for chapter in chapters %}
            <a href="{{ url_for('main.chapter_view_slug', novel_slug=novel.slug, volume_slug=volume.slug, chapter_slug=chapter.slug) }}" class="list-group-item list-group-item-action">
                {{ chapter.title }}
                {% if current_user.is_authenticated and current_user == novel.story.author %}
                <div class="float-end">
                    <a href="{{ url_for('main.edit_chapter', chapter_slug=chapter.slug) }}" class="btn btn-sm btn-outline-secondary">Edit</a>
                    <form method="POST" action="{{ url_for('main.delete_chapter', chapter_slug=chapter.slug) }}" style="display:inline;" onsubmit="return confirm('Delete this chapter?');">
                        <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                    </form>
                </div>
                {% endif %}
            </a>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">No chapters yet.</p>
    {% endif %}
</div>
{% endblock %}
