{% extends "base.html" %}
{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card mb-4 shadow-sm">
                <div class="card-body">
                    <h3 class="card-title mb-4">Settings</h3>
                    
                    <form method="POST" action="{{ url_for('main.settings') }}" id="settingsForm">
                        <div class="mb-4">
                            <h5>Edit Profile</h5>
                            <a href="{{ url_for('main.edit_profile') }}" class="btn btn-outline-primary">Edit Profile</a>
                        </div>
                        <hr>
                        
                        <div class="mb-4">
                            <h5>Theme</h5>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="themeSwitch" name="theme" value="dark" {% if current_user.theme == 'dark' %}checked{% endif %}>
                                <label class="form-check-label" for="themeSwitch">Dark Mode</label>
                            </div>
                            <small class="text-muted d-block mt-2">Choose between light and dark theme. Your preference will be saved across devices.</small>
                        </div>
                        <hr>
                        
                        <div class="mb-4">
                            <h5>Saved List Privacy</h5>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="hideSavedListSwitch" name="hide_saved_list" {% if current_user.hide_saved_list %}checked{% endif %}>
                                <label class="form-check-label" for="hideSavedListSwitch">
                                    Hide my saved list from other users
                                </label>
                            </div>
                        </div>
                        <hr>
                        
                        <div class="mb-4">
                            <h5>Recent Reads Privacy</h5>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="hideRecentReadsSwitch" name="hide_recent_reads" {% if current_user.hide_recent_reads %}checked{% endif %}>
                                <label class="form-check-label" for="hideRecentReadsSwitch">
                                    Hide my recent reads from other users
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <button type="submit" class="btn btn-primary">Save All Settings</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const themeSwitch = document.getElementById('themeSwitch');
    if (!themeSwitch) {
        console.error('No element with id themeSwitch found!');
        return;
    }
    themeSwitch.checked = document.documentElement.getAttribute('data-theme') === 'dark';
    themeSwitch.addEventListener('change', function() {
        const theme = this.checked ? 'dark' : 'light';
        console.log('Theme toggled, new theme:', theme);
        setTheme(theme);
    });
});
</script>
{% endblock %}