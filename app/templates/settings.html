{% extends "base.html" %}
{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card mb-4 shadow-sm">
                <div class="card-body">
                    <h3 class="card-title mb-4">Settings</h3>
                    <div class="mb-4">
                        <h5>Edit Profile</h5>
                        <a href="{{ url_for('main.edit_profile') }}" class="btn btn-outline-primary">Edit Profile</a>
                    </div>
                    <hr>
                    <div>
                        <h5>Theme</h5>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="darkModeSwitch">
                            <label class="form-check-label" for="darkModeSwitch">Enable Dark Mode</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block scripts %}
{{ super() }}
<script>
// Settings page dark mode toggle logic

// Use DOMContentLoaded to ensure the page structure is loaded
document.addEventListener('DOMContentLoaded', function() {
    console.log('settings.html script start (DOMContentLoaded)');
    
    const darkModeSwitch = document.getElementById('darkModeSwitch');

    if (darkModeSwitch) {
        console.log('settings.html: darkModeSwitch element found!', darkModeSwitch);

        // Set initial state of the switch based on localStorage
        const currentTheme = localStorage.getItem('theme');
        console.log('settings.html: Initial theme from localStorage:', currentTheme);

        if (currentTheme === 'dark') {
            darkModeSwitch.checked = true;
            console.log('settings.html: Initial switch state set to checked (dark)');
        } else {
            darkModeSwitch.checked = false;
            console.log('settings.html: Initial switch state set to unchecked (light)');
        }

        // Add event listener for toggling
        darkModeSwitch.addEventListener('change', function() {
            console.log('settings.html: darkModeSwitch toggled');
            if (this.checked) {
                localStorage.setItem('theme', 'dark');
                document.body.classList.add('dark-mode'); // Apply immediately for feedback
                console.log('settings.html: Dark mode enabled, localStorage set to dark');
            } else {
                localStorage.setItem('theme', 'light');
                document.body.classList.remove('dark-mode'); // Apply immediately for feedback
                console.log('settings.html: Dark mode disabled, localStorage set to light');
            }
        });

    } else {
        console.error('settings.html: darkModeSwitch element NOT found!');
        // Log nearby HTML to help diagnose if element ID is wrong or HTML not loaded
        const themeContainer = document.querySelector('.form-check.form-switch');
        if(themeContainer) {
             console.log('settings.html: Parent container HTML:', themeContainer.innerHTML);
        } else {
             console.log('settings.html: Theme container not found either.');
        }
    }
    console.log('settings.html script end (DOMContentLoaded)');
});

// Also add a window.onload listener as a fallback/comparison
window.onload = function() {
    console.log('settings.html script start (window.onload)');
    const darkModeSwitchOnLoad = document.getElementById('darkModeSwitch');
    if(darkModeSwitchOnLoad) {
        console.log('settings.html: darkModeSwitch element found on window.onload!', darkModeSwitchOnLoad);
    } else {
        console.error('settings.html: darkModeSwitch element NOT found on window.onload!');
    }
    console.log('settings.html script end (window.onload)');
};

</script>
{% endblock %} 